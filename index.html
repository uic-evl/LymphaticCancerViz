<html>

<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="src/css/custom.css">
    <link rel="stylesheet" href="src/css/main.css">
    <link rel="stylesheet" href="src/css/menu.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.13.1/lodash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-debug.js"></script>

    <script src="https://code.jquery.com/jquery-2.1.2.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>

</head>

<body>

<script src="src/js/utilities.js"></script>
<script src="src/js/main.js"></script>
<script src="src/js/model.js"></script>


<!--<select id='cluster' style='margin-top: 10px; margin-bottom:10px; margin-left: 20px;'-->
        <!--data-bind=" options: clusters,-->
                      <!--value: currentCluster,-->
                      <!--optionsCaption: clusterCaption">-->
<!--</select>-->

<div class="container-fluid" style="margin-bottom: 10px;">
    <div class="row">

        <div class="col-md-2">
            <select id='selectionType' class="btn menu"
                    data-bind=" options: selections, value: currentType">
            </select>
        </div>

        <!-- ko if: currentType() === "By Patient" -->
        <div class="col-md-5">

            <select id='patientSelection' class="btn menu"
                    data-bind="
                    options: patients,
                    optionsText: function(item) {
                       return 'Patient ' + item.id;
                   },
                    value: currentPatient,
                    optionsCaption: optionsCaption">
            </select>

            <select id='sortingAlgorithms' class="btn menu"
                    data-bind="visible: sortingAlgorithms().length > 0,  options: sortingAlgorithms,
                      value: currentSorting" >
            </select>

            <select id='numberOfPatients' class="btn menu"
                    data-bind=" options: numberToDisplay,
                     optionsText: function(item) {
                       if(_.isNumber(item)) return 'Top ' + item + ' Patients';
                       else return item + ' Patients';
                   },
                      value: currentDisplay" >
            </select>

        </div>
        <!-- /ko -->

        <div class="col-md-2">
            <div class="dropdown">
                <a id="clusterLabel" data-toggle="dropdown" class="btn menu clusters"
                   data-target="#" data-bind="visible: currentType() === 'By Cluster' || currentPatient() ">ChiSquared Clusters
                    <span class="caret"></span>
                </a>
                <ul id="clusterMenu" class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu"
                    data-bind="foreach: clusters">
                    <li class="dropdown-submenu">
                        <a tabindex="-1" href="#"><span data-bind="text: name"></span></a>
                        <ul class="dropdown-menu" data-bind="foreach: count">
                            <li data-bind="css: {
                                disabled: $root.currentPatient()
                                       && $root.currentType() === 'By Patient'
                                       && $root.currentPatient().clusters.indexOf(name +'_'+ cluster) < 0,
                                highlighted: $root.currentPatient()
                                       && $root.currentType() === 'By Patient'
                                       && $root.currentPatient().clusters.indexOf(name +'_'+ cluster) > -1} ">
                                <a class="cluster" href="#">
                                  <span class="cluster" data-bind="text: 'Cluster ' + cluster, value: name"></span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <!-- ko if: currentType() === "By Cluster" && currentCluster() -->
        <div class="col-md-5">
            <select id='patientSelection' class="btn menu"
                    data-bind="
                    options: patients,
                    optionsText: function(item) {
                       return 'Patient ' + item.id;
                   },
                    value: currentPatient,
                    optionsCaption: optionsCaption">
            </select>

            <select id='numberOfPatients' class="btn menu"
                    data-bind=" options: numberToDisplay,
                      optionsText: function(item) {
                       if(_.isNumber(item)) return 'Top ' + item + ' Patients';
                       else return item + ' Patients';
                   },
                      value: currentDisplay" >
            </select>
        </div>
        <!-- /ko -->
    </div>
</div>


<div class="container-fluid">
    <!--<div data-bind="css: { row: ($index()+1) % $parent.maxNodes == 0 }">-->
    <div class="row" data-bind="foreach: rankings">
        <div class="patient_container" data-bind=" css: { 'col-md-2': $parent.maxNodes > 5, 'col-md-3': $parent.maxNodes < 6  } ">
            <div class="x_panel tile">
                <div class="x_title" data-bind="css: { male: gender=='male', female: gender=='female'}">
                    <h2 class="patient" data-bind="text: 'Patient '+patient"></h2>
                    <h2 class='tumor' data-bind="text: 'Tumor: '+position"></h2>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div data-bind="attr: {id: 'patient'+patient}" style="display: table; margin: auto;"></div>
                    <h2 class="stats">Similarity Score: <span class="bold" data-bind="text: score"></span></h2>
                    <h2 class="stats">Aspiration (pre/post): <span class="bold" data-bind="text: aspiration_pre + ' / ' + aspiration_post"></span></h2>
                    <h2 class="stats">Feeding Tube (pre/post): <span class="bold" data-bind="text: feedingTube_pre + ' / ' + feedingTube_post"></span></h2></div>
            </div>
        </div>
    </div>
</div>

</body>

</html>